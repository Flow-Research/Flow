# Changelog

All notable changes to Flow will be documented in this file.

The format is based on [Keep a Changelog](https://keepachangelog.com/en/1.0.0/),
and this project adheres to [Semantic Versioning](https://semver.org/spec/v2.0.0.html).

## [0.3.0] - 2025-11-25

> **Version Bump:** Minor version for new Bootstrap Node Support feature - prerequisite for GossipSub message routing.

### Added

#### Bootstrap Node Support
- **BootstrapConfig** struct for fine-grained control over bootstrap behavior with configurable options:
  - `auto_dial` - Automatically dial bootstrap peers on startup (default: true)
  - `auto_bootstrap` - Run Kademlia DHT bootstrap query on startup (default: true)
  - `startup_delay_ms` - Delay before bootstrap allowing listener initialization (default: 100ms)
  - `max_retries` - Maximum retry attempts per bootstrap peer (default: 3)
  - `retry_delay_base_ms` - Base delay for exponential backoff (default: 1000ms)
- **Bootstrap peer tracking** via `HashSet<PeerId>` identifying which peers are bootstrap nodes
- **Automatic retry with exponential backoff** for failed bootstrap peer connections (base_delay Ã— 2^attempts, capped at exponent 10)
- **Event-loop-driven bootstrap** with scheduled initial trigger after configurable startup delay
- **Periodic retry interval** (5 seconds) for disconnected bootstrap peers
- **Manual bootstrap trigger API** via `NetworkManager::trigger_bootstrap()` for reconnection scenarios
- **Bootstrap peer query API** via `NetworkManager::bootstrap_peer_ids()` to retrieve configured bootstrap peers
- **BootstrapResult** struct providing bootstrap operation outcomes (connected_count, failed_count, query_initiated)
- **DiscoverySource::Bootstrap** variant for tracking peer discovery origin

#### Testing
- **8 comprehensive bootstrap tests** covering:
  - Configuration defaults validation
  - Graceful handling when no bootstrap peers configured
  - Bootstrap peer parsing and tracking
  - Manual trigger API functionality
  - Invalid address filtering (addresses without `/p2p/` component)
  - Two-node bootstrap connection integration test
  - Retry logic with exponential backoff for unreachable peers
  - Partial success with mixed reachable/unreachable peers

### Changed

- Extended **NetworkConfig** with `bootstrap: BootstrapConfig` field
- Extended **NetworkEventLoop** with bootstrap peer state tracking and retry timer integration
- Extended **PersistentPeerRegistry** with forwarding methods: `bulk_load_known_peers()`, `is_connected()`, `get_reconnection_count()`
- Extended **NetworkCommand** enum with `TriggerBootstrap` and `GetBootstrapPeerIds` variants