# Flow Environment Configuration
# Copy this file to .env and fill in your values

# =============================================================================
# DATABASE
# =============================================================================
DATABASE_URL="sqlite:///db/data.sqlite?mode=rwc"
DB_MAX_CONNECTIONS=100
DB_MIN_CONNECTIONS=5
DB_CONNECT_TIMEOUT=8
DB_IDLE_TIMEOUT=600
DB_MAX_LIFETIME=1800
DB_LOGGING_ENABLED=false

# =============================================================================
# STORAGE
# =============================================================================
KV_STORE_PATH="$HOME/.config/flow/kv"

# =============================================================================
# SERVER
# =============================================================================
HOST=0.0.0.0
REST_PORT=8080
WEBSOCKET_PORT=8081
CORS_ORIGINS="http://localhost:3000,http://localhost:5173"

# =============================================================================
# VECTOR DATABASE (QDRANT)
# =============================================================================
QDRANT_URL="http://localhost:6334"
# Set to true for local/test instances without API key authentication
QDRANT_SKIP_API_KEY=false

# =============================================================================
# CACHE (REDIS) - Optional
# =============================================================================
# REDIS_URL="redis://localhost:6379"

# =============================================================================
# AI INDEXING
# =============================================================================
VECTOR_SIZE=384
MIN_CHUNK_SIZE=10
MAX_CHUNK_SIZE=20000
MAX_FILE_SIZE=10000000
EMBED_BATCH_SIZE=20
STORAGE_BATCH_SIZE=50
CONCURRENCY=4
RATE_LIMIT_MS=100
MAX_FAILURE_RATE=0.5
MIN_SAMPLE_SIZE=10

# File extensions to index (comma-separated)
ALLOWED_EXTENSIONS=md,rs,java,txt,py,ts,js,html,htm,ex,php,sol,c,cs,h,cpp,cxx,cc,go,rb,pdf,json,yaml,yml,toml

# Patterns to exclude from indexing (comma-separated)
# EXCLUDE_PATTERNS=node_modules,target,.git

# =============================================================================
# AI METADATA GENERATION (Optional - requires Ollama with llama3.2:3b)
# =============================================================================
ENABLE_METADATA_QA=false
ENABLE_METADATA_SUMMARY=false
ENABLE_METADATA_KEYWORDS=false

# =============================================================================
# DISTRIBUTED SEARCH
# =============================================================================
FLOW_SEARCH_RESPOND_TO_QUERIES=true
FLOW_SEARCH_MAX_RESULTS_PER_QUERY=10
FLOW_SEARCH_PEER_COUNT=5
FLOW_SEARCH_NETWORK_TIMEOUT_MS=5000
FLOW_SEARCH_RETRY_ENABLED=true
FLOW_SEARCH_CACHE_TTL_SECS=300
FLOW_SEARCH_CACHE_MAX_ENTRIES=1000

# =============================================================================
# P2P NETWORK (GOSSIPSUB)
# =============================================================================
GOSSIPSUB_ENABLED=true
GOSSIPSUB_HEARTBEAT_INTERVAL_MS=1000
GOSSIPSUB_MESH_N=6
GOSSIPSUB_MESH_N_LOW=4
GOSSIPSUB_MESH_N_HIGH=12
GOSSIPSUB_MAX_MESSAGE_SIZE=65536
GOSSIPSUB_VALIDATE_SIGNATURES=true

# Message persistence
GOSSIP_MESSAGE_DB_PATH="$HOME/.config/flow/gossip"
MESSAGE_STORE_ENABLED=true
MESSAGE_STORE_MAX_PER_TOPIC=10000
MESSAGE_STORE_MAX_TOTAL=100000
MESSAGE_STORE_CLEANUP_INTERVAL=60

# Network discovery
NETWORK_MDNS_QUERY_INTERVAL=5

# =============================================================================
# PEER REGISTRY
# =============================================================================
PEER_REGISTRY_DB_PATH="$HOME/.config/flow/peers"
PEER_REGISTRY_FLUSH_INTERVAL=30
PEER_REGISTRY_MAX_FAILURES=5
PEER_REGISTRY_TTL_SECS=86400

# =============================================================================
# WEBAUTHN
# =============================================================================
WEBAUTHN_RP_ID="localhost"
WEBAUTHN_RP_ORIGIN="http://localhost:3000"
WEBAUTHN_RP_NAME="Flow WebAuthn"

# =============================================================================
# LOGGING
# =============================================================================
RUST_LOG=info
# Per-module logging example:
# RUST_LOG=node::modules::network=debug,node::modules::ai=trace
